# psコマンド
今、Linuxのコマンドラインから実行したプログラムは、ちゃんと動いているのか？

それを確認できるコマンドはいくつかありますが、まずpsを使いましょう。

もし、何も動いていなければ次のような表示になるはずです。
```
$ ps
  PID TTY          TIME CMD
 7513 pts/4    00:00:00 bash
 8625 pts/4    00:00:00 ps
```
ここに表示されたのは、今利用しているシェルであるbashと、これを
表示しているpsのみです。

実験用にsleep.cというプログラムを作成したので、これを利用して試してみましょう。
このプログラムは簡単な足し算を行いますが、結果を表示する前に90秒間、何もしないで待ちます。

コンパイル:
```
gcc -o sleep sleep.c
```
実行:
```
./sleep &
```
確認:
```
$ ps
  PID TTY          TIME CMD
 2653 pts/3    00:00:00 bash
 8870 pts/3    00:00:00 sleep
 8871 pts/3    00:00:00 ps
```
このようにプログラム名"sleep"が表示されます。

## psで表示されない場合
このような単純なプログラムの場合はpsで必ず表示されますが、
実行した解析プログラムがpsで表示されなかった場合、何が起きているのでしょうか？

これにはいくつかのケースがあります。
1. 既に正常終了してしまっており、意図した結果も出ている
2. 既に異常終了してしまっている
3. 既に正常終了しているが、意図した動作ではない
4. SGEなど分散システムを利用しているため、別のホストで計算の実行が行われている
5. 実行したプログラムが別のプログラムを呼び出し、その別のプログラムが計算している

### 既に正常終了してしまっており、意図した結果も出ている
この場合、特に何もする必要はないでしょう。
### 既に異常終了してしまっている
エラーメッセージやログファイルがあれば、その内容を確認して
障害を解消できるように対策することになります。
### 既に正常終了しているが、意図した動作ではない
これは厄介です。正常終了したということは、何かプログラムの動作中に
発生した問題が、開発者が想定していなかったものであったため、
問題が見過ごされて正常終了してしまったことを意味します。
プログラムや入力データについて詳細な調査が必要になります。
### SGEなど分散システムを利用しているため、別のホストで計算の実行が行われている
SlurmやSGEのような分散システムを利用している場合、手元で実行した
コマンドから呼び出されたプログラムは別のホスト(計算機)で実行されるのが一般的です。
qstatなどのそれぞれの分散システムのコマンドで動作状態を確認するようにしましょう。
### 実行したプログラムが別のプログラムを呼び出し、その別のプログラムが計算している
例えば、あなたがPythonのプログラムを起動した後、そのPythonプログラムはC言語のプログラムや、
別のPythonのプログラムをプログラム内部から呼び出すことがあります。特にパイプラインなどと
呼ばれるプログラムにそのようなものが多くあります。中には呼び出した側のプログラムは
呼び出し直後には終了してしまい、呼び出されたプログラムが計算を担う場合はpsでは
呼び出されたプログラムしか表示されないでしょう。

## psで表示される場合でも？

psで実行したプログラムが表示される場合でも以下のような場合があります。

1. プログラムは生きており、計算が行われている
2. プログラムは生きており、計算が行われているようだが進んでいない
3. プログラムは生きているが、CPUが使われておらず計算を行っているように見えない

本書がこれから問題として扱うのは、この2や3の状況です。
